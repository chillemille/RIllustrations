<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 3 Preparation of RNA-Seq data set used for illustration | RNA Sequencing Guide</title>

    <meta name="author" content="Milena Wünsch and Pat Callahan" />
  
   <meta name="description" content="This is a book about…" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 3 Preparation of RNA-Seq data set used for illustration | RNA Sequencing Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book about…" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Preparation of RNA-Seq data set used for illustration | RNA Sequencing Guide" />
  
  <meta name="twitter:description" content="This is a book about…" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.5.0/transition.js"></script>
    <script src="libs/bs3compat-0.5.0/tabs.js"></script>
    <script src="libs/bs3compat-0.5.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">RNA Sequencing Guide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="preparation-of-rna-seq-data-set-used-for-illustration" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Preparation of RNA-Seq data set used for illustration</h1>
<p>The RNA-Seq data set we will use for this illustration is provided by Pickrell et al. (2010) and is part of the library tweeDEseqCountData. In this data set, the sample conditions (i.e. phenotypes) of the respective samples correspond to the genders. For the purpose of simplicity and readability, we store the gene expression measurements and sample conditions in objects with neutral names.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-1" tabindex="-1"></a><span class="co"># load pickrell data set </span></span>
<span id="cb3-2"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-2" tabindex="-1"></a><span class="fu">data</span>(pickrell)</span>
<span id="cb3-3"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-4" tabindex="-1"></a><span class="co"># access and store gene expression measurements</span></span>
<span id="cb3-5"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-5" tabindex="-1"></a>expression_data <span class="ot">&lt;-</span> Biobase<span class="sc">::</span><span class="fu">exprs</span>(pickrell.eset)</span>
<span id="cb3-6"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-6" tabindex="-1"></a><span class="co"># access and store sample conditions </span></span>
<span id="cb3-7"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-7" tabindex="-1"></a>sample_conditions <span class="ot">&lt;-</span> pickrell.eset<span class="sc">$</span>gender </span>
<span id="cb3-8"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-10" tabindex="-1"></a><span class="co"># take a look at the gene expression measurements: </span></span>
<span id="cb3-11"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-11" tabindex="-1"></a><span class="fu">head</span>(expression_data, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb3-12"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-12" tabindex="-1"></a><span class="co">#&gt;                 NA18486 NA18498 NA18499 NA18501 NA18502</span></span>
<span id="cb3-13"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-13" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-14"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-14" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-15"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-15" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      22     105      40      55      67</span></span>
<span id="cb3-16"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-16" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      22     100     107      53      72</span></span>
<span id="cb3-17"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-17" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460       5      23      10      18      15</span></span>
<span id="cb3-18"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-18" tabindex="-1"></a><span class="co">#&gt;                 NA18504 NA18505 NA18507 NA18508 NA18510</span></span>
<span id="cb3-19"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-19" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       5       0       0       0</span></span>
<span id="cb3-20"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-20" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-21"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-21" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      37      88     127      70      43</span></span>
<span id="cb3-22"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-22" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      38      98      69      66      43</span></span>
<span id="cb3-23"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-23" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460       8      11      16      18       7</span></span>
<span id="cb3-24"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-24" tabindex="-1"></a><span class="co">#&gt;                 NA18511 NA18516 NA18517 NA18519 NA18520</span></span>
<span id="cb3-25"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-25" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-26"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-26" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-27"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-27" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419     104      42      66      58      82</span></span>
<span id="cb3-28"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-28" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457     103      51      91      87      77</span></span>
<span id="cb3-29"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-29" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460       9       7      19      15      22</span></span>
<span id="cb3-30"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-30" tabindex="-1"></a><span class="co">#&gt;                 NA18522 NA18523 NA18852 NA18853 NA18855</span></span>
<span id="cb3-31"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-31" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-32"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-32" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-33"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-33" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      95      40      32      30      34</span></span>
<span id="cb3-34"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-34" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      87      39      65      50      43</span></span>
<span id="cb3-35"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-35" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460      17       7      14       8       5</span></span>
<span id="cb3-36"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-36" tabindex="-1"></a><span class="co">#&gt;                 NA18856 NA18858 NA18861 NA18862 NA18870</span></span>
<span id="cb3-37"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-37" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       1       0       0       0</span></span>
<span id="cb3-38"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-38" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-39"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-39" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      44      47     113      79      38</span></span>
<span id="cb3-40"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-40" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      48      52     117      73      50</span></span>
<span id="cb3-41"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-41" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460      13      15      23      15       8</span></span>
<span id="cb3-42"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-42" tabindex="-1"></a><span class="co">#&gt;                 NA18871 NA18909 NA18912 NA18913 NA18916</span></span>
<span id="cb3-43"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-43" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-44"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-44" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-45"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-45" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      41      95      45      54      49</span></span>
<span id="cb3-46"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-46" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      72      93      44      73      81</span></span>
<span id="cb3-47"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-47" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460       8      17       2       7       8</span></span>
<span id="cb3-48"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-48" tabindex="-1"></a><span class="co">#&gt;                 NA19093 NA19098 NA19099 NA19101 NA19102</span></span>
<span id="cb3-49"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-49" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-50"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-50" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-51"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-51" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      80      86      73      59      36</span></span>
<span id="cb3-52"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-52" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457     103     158     118      89      15</span></span>
<span id="cb3-53"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-53" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460      15      15      25      13       2</span></span>
<span id="cb3-54"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-54" tabindex="-1"></a><span class="co">#&gt;                 NA19108 NA19114 NA19116 NA19119 NA19127</span></span>
<span id="cb3-55"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-55" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-56"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-56" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-57"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-57" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419     124      56      64      25     104</span></span>
<span id="cb3-58"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-58" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457     108      19     150      16      38</span></span>
<span id="cb3-59"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-59" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460      16       6      28       2      18</span></span>
<span id="cb3-60"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-60" tabindex="-1"></a><span class="co">#&gt;                 NA19128 NA19130 NA19131 NA19137 NA19138</span></span>
<span id="cb3-61"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-61" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       1</span></span>
<span id="cb3-62"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-62" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-63"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-63" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      94     117      62      43      46</span></span>
<span id="cb3-64"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-64" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      50     104     113      71     120</span></span>
<span id="cb3-65"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-65" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460      22      25      19      14      10</span></span>
<span id="cb3-66"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-66" tabindex="-1"></a><span class="co">#&gt;                 NA19140 NA19143 NA19144 NA19147 NA19152</span></span>
<span id="cb3-67"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-67" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-68"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-68" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-69"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-69" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      94      82      56      96      66</span></span>
<span id="cb3-70"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-70" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      46     106      74     116     102</span></span>
<span id="cb3-71"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-71" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460      21       6      16      13      24</span></span>
<span id="cb3-72"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-72" tabindex="-1"></a><span class="co">#&gt;                 NA19153 NA19159 NA19160 NA19171 NA19172</span></span>
<span id="cb3-73"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-73" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-74"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-74" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-75"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-75" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      78      24      63      34      66</span></span>
<span id="cb3-76"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-76" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457     119      29      64      55      70</span></span>
<span id="cb3-77"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-77" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460      21       7       9      15      17</span></span>
<span id="cb3-78"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-78" tabindex="-1"></a><span class="co">#&gt;                 NA19190 NA19192 NA19193 NA19200 NA19201</span></span>
<span id="cb3-79"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-79" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       2</span></span>
<span id="cb3-80"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-80" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       1       0       0</span></span>
<span id="cb3-81"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-81" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      70      85      43      27      77</span></span>
<span id="cb3-82"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-82" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457     102      89      31      68      96</span></span>
<span id="cb3-83"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-83" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460       8      28      10       5      16</span></span>
<span id="cb3-84"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-84" tabindex="-1"></a><span class="co">#&gt;                 NA19203 NA19204 NA19209 NA19210 NA19222</span></span>
<span id="cb3-85"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-85" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0       0</span></span>
<span id="cb3-86"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-86" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0       0</span></span>
<span id="cb3-87"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-87" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      82      57      63      89      60</span></span>
<span id="cb3-88"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-88" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      58      86     113      48      71</span></span>
<span id="cb3-89"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-89" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460      10      19      17      12      12</span></span>
<span id="cb3-90"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-90" tabindex="-1"></a><span class="co">#&gt;                 NA19225 NA19238 NA19239 NA19257</span></span>
<span id="cb3-91"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-91" tabindex="-1"></a><span class="co">#&gt; ENSG00000000003       0       0       0       0</span></span>
<span id="cb3-92"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-92" tabindex="-1"></a><span class="co">#&gt; ENSG00000000005       0       0       0       0</span></span>
<span id="cb3-93"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-93" tabindex="-1"></a><span class="co">#&gt; ENSG00000000419      76      69      84      76</span></span>
<span id="cb3-94"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-94" tabindex="-1"></a><span class="co">#&gt; ENSG00000000457      81      73      87      81</span></span>
<span id="cb3-95"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-95" tabindex="-1"></a><span class="co">#&gt; ENSG00000000460       7      21      35      11</span></span>
<span id="cb3-96"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-96" tabindex="-1"></a><span class="co"># take a look at the sample conditions:</span></span>
<span id="cb3-97"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-97" tabindex="-1"></a>sample_conditions</span>
<span id="cb3-98"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-98" tabindex="-1"></a><span class="co">#&gt;  [1] male   male   female male   female male   female male  </span></span>
<span id="cb3-99"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-99" tabindex="-1"></a><span class="co">#&gt;  [9] female male   female male   female male   female male  </span></span>
<span id="cb3-100"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-100" tabindex="-1"></a><span class="co">#&gt; [17] female female male   female male   female female male  </span></span>
<span id="cb3-101"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-101" tabindex="-1"></a><span class="co">#&gt; [25] female male   female female male   female female male  </span></span>
<span id="cb3-102"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-102" tabindex="-1"></a><span class="co">#&gt; [33] female male   female female female female male   female</span></span>
<span id="cb3-103"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-103" tabindex="-1"></a><span class="co">#&gt; [41] male   male   female female male   female female male  </span></span>
<span id="cb3-104"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-104" tabindex="-1"></a><span class="co">#&gt; [49] female female male   female male   male   female female</span></span>
<span id="cb3-105"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-105" tabindex="-1"></a><span class="co">#&gt; [57] male   female male   female male   female female male  </span></span>
<span id="cb3-106"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-106" tabindex="-1"></a><span class="co">#&gt; [65] female female female male   female</span></span>
<span id="cb3-107"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-107" tabindex="-1"></a><span class="co">#&gt; Levels: female male</span></span>
<span id="cb3-108"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-108" tabindex="-1"></a></span>
<span id="cb3-109"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-109" tabindex="-1"></a><span class="co"># inspect the number of genes (rows) and the number of samples (columns) in the gene expression data set </span></span>
<span id="cb3-110"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-110" tabindex="-1"></a><span class="fu">dim</span>(expression_data)</span>
<span id="cb3-111"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb3-111" tabindex="-1"></a><span class="co">#&gt; [1] 52580    69</span></span></code></pre></div>
<div id="option-1-pre-filtering-using-edgers-builting-function" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Option 1: Pre-Filtering using edgeR’s builting function</h2>
<p>This approach works with the function filterByExpr() from the package edgeR and is the proposed method for pre-filtering for the methods for differential expression analysis edgeR and voom/limma. This approach operates on the cpm-transformed count data (cpm: counts-per-million), which excludes all genes that do NOT have a certain number of counts-per-million in a certain number of samples. Note that this approach accounts for differences in the library size between the different samples.</p>
<div id="step-1-generate-input-object-required-by-filterbyexpr" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> step 1: Generate input object required by filterByExpr()</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb4-1" tabindex="-1"></a>expression_data_filterByExpr <span class="ot">&lt;-</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> expression_data, </span>
<span id="cb4-2"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb4-2" tabindex="-1"></a>                                        <span class="at">group =</span> sample_conditions)</span></code></pre></div>
<p>Function description:</p>
<ul>
<li>DGEList(): object to contain RNA sequencing measurements and additional information</li>
</ul>
<p>Argument description:</p>
<ul>
<li>counts: matrix of RNA-Seq data</li>
<li>group: vector that contains the condition of each sample</li>
</ul>
</div>
<div id="step-2-pre-filtering" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> step 2: Pre-filtering</h3>
<p>The function filterByExpr() creates an indicator which on which genes do and which do not have a sufficient amount of read counts across all samples. Based on this indicator, the gene expression data set is then filtered.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb5-1" tabindex="-1"></a><span class="co"># (i) for each gene, indicate if it fulfils the requirements to be kept for the subsequent analysis </span></span>
<span id="cb5-2"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb5-2" tabindex="-1"></a>indicator_keep <span class="ot">&lt;-</span> <span class="fu">filterByExpr</span>(expression_data_filterByExpr)</span>
<span id="cb5-3"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb5-4" tabindex="-1"></a><span class="co"># (ii) filter the gene expression data set such that only those genes are kept which fulfill the requirements</span></span>
<span id="cb5-5"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb5-5" tabindex="-1"></a>expression_data_filterByExpr <span class="ot">&lt;-</span> expression_data_filterByExpr[indicator_keep,, keep.lib.sizes <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div>
<p>Note that the index “keep.lib.sizes = FALSE” ensures that the library size of each sample is recalculated after pre-filtering.</p>
</div>
<div id="step-3-obtain-final-pre-filtered-gene-expression-data-set" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> step 3: Obtain final pre-filtered gene expression data set</h3>
<p>At this point, we transform the gene expression measurements back to a data frame. The reason for this is that some subsequent steps (such as the conversion of gene IDs do not work with the DGEList format).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb6-1" tabindex="-1"></a>expression_data_filterByExpr <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(expression_data_filterByExpr<span class="sc">$</span>counts)</span>
<span id="cb6-2"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb6-3" tabindex="-1"></a><span class="co"># inspect the number of genes and the number of samples in the final pre-filtered gene expression data set </span></span>
<span id="cb6-4"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb6-4" tabindex="-1"></a><span class="fu">nrow</span>(expression_data_filterByExpr)</span>
<span id="cb6-5"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb6-5" tabindex="-1"></a><span class="co">#&gt; [1] 6246</span></span></code></pre></div>
<p>Observe that the number of genes has been reduced compared to the original (unfiltered) gene expression data set.</p>
</div>
</div>
<div id="option-2-simpler-pre-filtering-approach-proposed-by-deseq2" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Option 2: Simpler Pre-filtering approach (proposed by DESeq2)</h2>
<p>A simpler approach for pre-filtering has been proposed by the method for differential expression analysis DESeq2 (see file “Instructions_Differential_Expression_Analysis”. In this approach, only those genes are kept for further analysis that have a pre-specified number of counts X (such as 10) across all samples. A higher value of X thereby leads to more genes being removed.<br />
Note that DESeq2 proposes a stricter version of pre-filtering in which those genes are kept which have X number of counts in at least Y samples.<br />
Note that none of the these two “simpler” approaches to pre-filtering take differences in library size into account.</p>
<div id="step-1-pre-filtering" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> step 1: Pre-Filtering</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb7-1" tabindex="-1"></a><span class="co"># indicate which genes have at least 10 read counts across all samples:</span></span>
<span id="cb7-2"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb7-2" tabindex="-1"></a>indicator_keep <span class="ot">&lt;-</span> <span class="fu">rowSums</span>( expression_data ) <span class="sc">&gt;=</span> <span class="dv">10</span> </span>
<span id="cb7-3"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb7-4" tabindex="-1"></a><span class="co"># alternative (and more strict) indicator:</span></span>
<span id="cb7-5"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb7-5" tabindex="-1"></a><span class="co"># indicator_keep &lt;- rowSums( expression_data &gt;=10) &gt;= 10</span></span>
<span id="cb7-6"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb7-7" tabindex="-1"></a><span class="co"># subset gene expression data set accordingly </span></span>
<span id="cb7-8"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb7-8" tabindex="-1"></a>expression_data_filterDESEq2 <span class="ot">&lt;-</span> expression_data[indicator_keep,]</span></code></pre></div>
</div>
<div id="step-2-inspect-final-pre-filtered-gene-expression-data-set" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> step 2: Inspect final pre-filtered gene expression data set</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb8-1" tabindex="-1"></a><span class="fu">dim</span>(expression_data_filterDESEq2)</span>
<span id="cb8-2"><a href="preparation-of-rna-seq-data-set-used-for-illustration.html#cb8-2" tabindex="-1"></a><span class="co">#&gt; [1] 10151    69</span></span></code></pre></div>
<p>Note that the number of genes in the gene expression data set has decreased compared to the initial (unfiltered) gene expression data set.</p>

</div>
</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>RNA Sequencing Guide</strong>" was written by Milena Wünsch and Pat Callahan. It was last built on 2023-07-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


</body>

</html>
